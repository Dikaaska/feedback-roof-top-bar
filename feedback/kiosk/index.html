<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Roof Top Pool Bar Guest Feedback</title>
<link rel="icon" type="image/png" href="/kiosk/icon_hic.png">

<style>
body{
    margin:0;
    font-family:'Segoe UI',sans-serif;
    background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
    min-height:100vh;
}
.card{
    max-width:760px;
    margin:40px auto;
    background:#fff;
    padding:35px;
    border-radius:22px;
    box-shadow:0 20px 45px rgba(0,0,0,.15);
}
.header{text-align:center;margin-bottom:25px}
.header h2{color:#5b2c83;letter-spacing:1px}
.logo-header{text-align:center;margin-bottom:15px}
.logo-header img{width:140px;max-width:60%}

.guest-info{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:16px;
    margin-bottom:30px;
}
.guest-info input{
    padding:14px;
    border-radius:12px;
    border:1px solid #ccc;
    font-size:16px;
}

.feedback-group{display:flex;gap:16px;margin-bottom:28px}
.feedback-btn{flex:1;cursor:pointer}
.feedback-btn input{display:none}

.feedback-btn span{
    display:flex;
    align-items:center;
    justify-content:center;
    height:90px;
    border-radius:18px;
    font-size:42px;
    transition:all .3s ease;
    box-shadow:0 6px 15px rgba(0,0,0,.08);
    color:#fff;
}

/* DEFAULT BACKGROUND */
.good span{background:#c9f2d5}
.average span{background:#fff1c1}
.bad span{background:#ffd2d2}

/* ACTIVE ‚Äî BACKGROUND NYALA */
.good input:checked + span{
    background:linear-gradient(135deg,#34c759,#0b6623);
    box-shadow:0 10px 28px rgba(52,199,89,.55);
    transform:scale(1.08);
}
.average input:checked + span{
    background:linear-gradient(135deg,#ffca28,#ff9800);
    box-shadow:0 10px 28px rgba(255,152,0,.55);
    transform:scale(1.08);
}
.bad input:checked + span{
    background:linear-gradient(135deg,#ef5350,#a42828);
    box-shadow:0 10px 28px rgba(239,83,80,.55);
    transform:scale(1.08);
}

/* EMOJI DEFAULT */
.feedback-btn span::after{
    content:attr(data-default);
}

/* EMOJI BERUBAH */
.good input:checked + span::after{content:"üòç";}
.average input:checked + span::after{content:"üòê";}
.bad input:checked + span::after{content:"üò°";}

button{
    width:100%;
    padding:18px;
    font-size:20px;
    background:#ad02fc;
    color:#fff;
    border:none;
    border-radius:16px;
    cursor:pointer;
}
button:disabled{opacity:.6}

.error-msg{color:#c62828;font-size:14px;display:none}
.feedback-group.error{
    border:2px solid #c62828;
    border-radius:20px;
    padding:6px;
}

.footer{text-align:center;color:#666;margin-top:20px;font-size:14px}
</style>
</head>

<body>

<!-- POP SOUND -->
<audio id="popSound" preload="auto">
<source src="https://assets.mixkit.co/sfx/preview/mixkit-select-click-1109.mp3">
</audio>

<!-- CONFETTI -->
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<div class="card">
<div class="header">
<div class="logo-header"><img src="logo_hic.png"></div>
<h2>ROOF TOP POOL BAR</h2>
<p>We value your feedback</p>
</div>

<form id="f">

<div class="guest-info">
<input type="text" name="guest_name" placeholder="Guest Name (optional)">
<input type="text" name="room_number" placeholder="Room Number (optional)">
</div>

<!-- QUESTION TEMPLATE -->
<script>
function q(n,l){
document.write(`
<p><strong>${l}</strong></p>
<div class="error-msg" id="err-${n}"></div>
<div class="feedback-group">
<label class="feedback-btn good">
<input type="radio" name="${n}" value="Good">
<span data-default="üôÇ"></span>
</label>
<label class="feedback-btn average">
<input type="radio" name="${n}" value="Average">
<span data-default="üòê"></span>
</label>
<label class="feedback-btn bad">
<input type="radio" name="${n}" value="Bad">
<span data-default="üòû"></span>
</label>
</div>
`);
}
q("food","How's the Food & Beverage ?");
q("pool","How's your swimming experience ?");
q("music","How's the Music ?");
q("wifi","How's the Wi-Fi Connection ?");
</script>

<button type="submit" id="submitBtn">Submit Feedback</button>
</form>

<div class="footer">Thank you for your feedback</div>
</div>

<script>
const pop=document.getElementById("popSound");

/* POP SOUND */
document.querySelectorAll('input[type="radio"]').forEach(r=>{
    r.addEventListener("change",()=>{
        pop.currentTime=0;
        pop.play();
    });
});

/* SUBMIT */
document.getElementById("f").addEventListener("submit",function(e){
e.preventDefault();
let ok=true;
["food","pool","music","wifi"].forEach(n=>{
    const err=document.getElementById("err-"+n);
    const g=document.querySelector(`input[name="${n}"]`).closest(".feedback-group");
    err.style.display="none";g.classList.remove("error");
    if(!document.querySelector(`input[name="${n}"]:checked`)){
        err.innerText="Please select this option";
        err.style.display="block";g.classList.add("error");
        ok=false;
    }
});
if(!ok) return;

confetti({particleCount:150,spread:90,origin:{y:.6}});

setTimeout(()=>{
fetch("../api/save_feedback.php",{method:"POST",body:new FormData(this)})
.then(r=>r.text())
.then(t=>{ if(t.trim()==="OK") location.href="thank_you.html"; });
},600);
});
</script>

<script>
history.pushState(null,null,location.href);
window.onpopstate=()=>history.go(1);
</script>

</body>
</html>
